import{r as d,A as g,j as e,L as j}from"./index-YdY7dRhB.js";import{u as w,C as I,I as i,V as b,c as y,a as T}from"./form-hook-DhkIvxSR.js";import{u as V,E as A}from"./http-hook-CmFLBJqP.js";const S=()=>{const o=d.useContext(g),[t,u]=d.useState(!0),{isLoading:m,error:c,sendRequest:l,clearError:h}=V(),[a,n,p]=w({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),x=()=>{t?p({...a.inputs,name:{value:"",isValid:!1}},!1):p({...a.inputs,name:void 0},a.inputs.email.isValid&&a.inputs.password.isValid),u(r=>!r)},v=async r=>{if(r.preventDefault(),t)try{const s=await l("https://todoapp-backend-vqt1.onrender.com/api/users/login","POST",JSON.stringify({email:a.inputs.email.value,password:a.inputs.password.value}),{"Content-Type":"application/json"});o.login(s.userId,s.name,s.token)}catch{}else try{const s=await l("https://todoapp-backend-vqt1.onrender.com/api/users/signup","POST",JSON.stringify({name:a.inputs.name.value,email:a.inputs.email.value,password:a.inputs.password.value}),{"Content-Type":"application/json"});o.login(s.userId,s.name,s.token)}catch{}},f=()=>{h()};return e.jsxs(e.Fragment,{children:[e.jsx(A,{error:c,onClear:f}),e.jsxs(I,{className:"auth-container",children:[m&&e.jsx(j,{asOverlay:!0}),e.jsxs("form",{onSubmit:v,className:"auth-form",children:[e.jsx("h3",{children:t?"login":"signup"}),!t&&e.jsx(i,{id:"name",element:"input",type:"text",placeholder:"name",validators:[b()],errorText:"Please enter a name.",onInput:n}),e.jsx(i,{id:"email",element:"input",name:"email",type:"email",placeholder:"email",validators:[y()],errorText:"Please enter a valid email address.",onInput:n}),e.jsx(i,{id:"password",element:"input",name:"password",type:"password",placeholder:"password",validators:[T(6)],errorText:"Please enter a valid password at least 6 characters.",onInput:n}),e.jsx("button",{type:"submit",disabled:!a.isValid,className:`auth-btn ${a.isValid?"":"btn-disabled"}`,children:t?"login":"signup"}),e.jsxs("button",{type:"button",onClick:x,className:"auth-text-button",children:["switch to ",t?"signup":"login"]})]})]})]})};export{S as default};
