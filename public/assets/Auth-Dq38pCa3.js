import{r as p,A as f,j as e,L as j}from"./index-BH1K1oee.js";import{u as w,a as b,E as I,C as y,I as i,V as T,d as V,b as A}from"./http-hook-Dube5ACe.js";const E=()=>{const o=p.useContext(f),[t,u]=p.useState(!0),{isLoading:m,error:c,sendRequest:l,clearError:h}=w(),[a,n,d]=b({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),x=()=>{t?d({...a.inputs,name:{value:"",isValid:!1}},!1):d({...a.inputs,name:void 0},a.inputs.email.isValid&&a.inputs.password.isValid),u(r=>!r)},v=async r=>{if(r.preventDefault(),t)try{const s=await l("https://todoapp-backend-vqt1.onrender.com/api/users/login","POST",JSON.stringify({email:a.inputs.email.value,password:a.inputs.password.value}),{"Content-Type":"application/json"});o.login(s.userId,s.name,s.token)}catch{}else try{const s=await l("https://todoapp-backend-vqt1.onrender.com/api/users/signup","POST",JSON.stringify({name:a.inputs.name.value,email:a.inputs.email.value,password:a.inputs.password.value}),{"Content-Type":"application/json"});o.login(s.userId,s.name,s.token)}catch{}},g=()=>{h()};return e.jsxs(e.Fragment,{children:[e.jsx(I,{error:c,onClear:g}),e.jsxs(y,{className:"auth-container",children:[m&&e.jsx(j,{asOverlay:!0}),e.jsxs("form",{onSubmit:v,className:"auth-form",children:[e.jsx("h3",{children:t?"login":"signup"}),!t&&e.jsx(i,{id:"name",element:"input",type:"text",placeholder:"name",validators:[T()],errorText:"Please enter a name.",onInput:n}),e.jsx(i,{id:"email",element:"input",name:"email",type:"email",placeholder:"email",validators:[V()],errorText:"Please enter a valid email address.",onInput:n}),e.jsx(i,{id:"password",element:"input",name:"password",type:"password",placeholder:"password",validators:[A(6)],errorText:"Please enter a valid password at least 6 characters.",onInput:n}),e.jsx("button",{type:"submit",disabled:!a.isValid,className:`btn ${a.isValid?"":"btn-disabled"}`,children:t?"login":"signup"}),e.jsxs("button",{type:"button",onClick:x,className:"auth-text-button",children:["switch to ",t?"signup":"login"]})]})]})]})};export{E as default};
